gaEOMONTH関数（開始日,月末日）
月末日を０にすると開始日の月の月末日、１なら翌月の月末日、-1なら先月の月末日を自動計算してシリアル値を算出し日付で表示してくれる。
一日をD6、月末日をG3にしていた場合
=IFS(D6=$G$3,"",D6="","",D6<>$G$3,D6+1)をG6に入力しAH6まで値をコピーすると自動で月を変えると最終日まで表示する日付を作ることが出来る。

・日付の日のみを表記したいときはセルを選択してユーザー定義　ｄ
・曜日を連動して買えたいときは数式のコピーをしてユーザー定義　aaa
・土曜日の文字を青くするときは、7列目を範囲選択して、条件付き書式の新しいルールで数式に=TEXT(D$7,"aaa")="土"を入れで書式の色を青にする
日曜日も同様
・土曜日と日曜日のマスを分かりやすくするために背景に灰色を塗る
表全体を範囲選択して条件式初期式の数式を＝OR（TEXT(D$7,"aaa")="土",TEXT(D$7,"aaa")="日"）にして書式の背景の色を灰色にする。
・祝日の設定
ホームページなどで国民の祝日リストをコピーして別シートに張り付ける。元のシートに戻って条件付き書式で７行目を範囲選択して=COUNTIF(祝日リスト!$B:$B,D$7)=1として書式の色を赤にする。
同じように表全体を範囲選択して同じ数式を打つ。

出勤日数を求めるには
=TEXT($G$3,"d")-COUNTIF(D7:AH7,"休み"）
7列目の人の出勤回数、G3は月末日、休みはシフト上の休みの表記

人数のチェック表を作る
作った勤務形態の表を作りCOUNTIF関数で表示する
例えばD8セルからD37までの範囲のC38の勤務形態を数えさらにすべてのセルが空白の時に空白にしておきたいのでD38セルに
=IF(COUNTA(D$8:D$37)=0,"",COUNTIF(D$8:D$37,$C38))
と入力し
勤務形態の最後に人数チェック欄を作り（例えば４０行目なら）D40セルに
=IF(D39="","",IF(COUNTIF(D38:D39,0)=0,"〇","×"))と入力する
事で空白だったら空白、(D38:D39に０が無ければ〇、あれば×を表示できるようになる。

休み希望を考慮したシフトの自動生成
まず、シフト表の一番上（例えばD6:AH40の列なら１列空けてAJ）に１行空けて５列ずつ外枠罫線で囲いすぐ下の範囲から表の下（シフトの表の範囲）まで格子で囲う
出来た表の左側のタイトルに休暇希望日　右側に休み希望記入欄と入れる
すぐ下の欄に１から５の数字を打ち第五希望まで休みを取れるようにしておく
一人目の休暇希望日の第一希望に
=IF(AP8="","",DATE($D$1,$G$1,AP8))と打って
希望欄の数値をシリアル値に変えユーザー定義で日付だけが表示されるようにしておく。
次に首都表に数式を打つためにドロップダウンリストを設定している範囲を選択
データの入力規則でエラーメッセージの
無効なデータが入力されたらエラーメッセージを表示するのチェックを外す
これでリストは残しつつ数式も記入できるようになる

D8セル（１人目の１日）に
=IF(D$6="","",IF(COUNTIFS($AJ8:$AN8,$D$6)=1,"-",SWITCH(RANDBETWEEN(1,3),1,$O$2,2,$P$2,3,$Q$2)))
と打つ
IF関数の論理式に休み希望欄に日付と同じ数字のシリアル値が入っていたら - が表示されるようにしている
IF関数の偽の値
SWICH関数では式の値に応じでシフト表の勤務形態を指定している
SWICH関数の式のRANDBETWEEN関数で1~3のうちランダム表示されるようにしている。
つまりもし日付がない場合は空白、休み希望が出ていれば-そうでなければランダムな数値が割り振られそれに応じたシフトが組まれるという
数式になる

休み希望を分かりやすくする
シフト表の一列目を範囲選択し、条件付き書式の数式を
=COUNTIF($A$8:$AN$8,D$6)>0
文字のスタイルを太字、色を赤に設定
数式をコピーしておいてOK
他の列にも設定すると見ただけで休み希望が分かりやすくなる

$A$8:$AN$8は休み希望の表,D$6は日付
